# 多 QB 容器管理 Web 控制页面 — 需求文档

## 1. 项目概述

目标是开发一个基于 Web 的 **多 QB 容器管理系统**，提供可视化界面管理多个 qBittorrent 实例。用户能够通过单个 Web 页面：

- 添加、删除、切换多个 QB 容器。
- 查看和操作种子（开始/暂停/删除/修改标签等）。
- 支持移动端和桌面端的响应式布局。
- 在大量种子（上千条）情况下依然保持高性能。

整个系统采用 **单一 Docker 容器**部署，包含前端、后端和数据库，用户只需启动 Docker 即可使用。

---

## 2. 技术架构

### 2.1 后端

- **语言/框架**：Node.js + Fastify
- **数据库**：SQLite
- **职责**：
  - 管理 QB 容器信息（IP、端口、用户名、密码）
  - 缓存种子信息，减少前端直接访问 QB 的压力
  - 提供 RESTful API / WebSocket 给前端调用
  - 安全存储账户信息（可选加密）
  - 定时更新种子状态（可配置刷新间隔）

### 2.2 前端

- **框架/工具**：React + Vite + TailwindCSS
- **特效/动画**：Framer Motion
- **大列表渲染优化**：react-window（虚拟滚动）
- **职责**：
  - 响应用户操作，展示种子列表和控制按钮
  - 支持无限滚动，上千条种子不卡顿
  - 响应式布局，兼容手机/平板/PC
  - 酷炫过渡动画和交互效果
  - 调用后端 API 获取 QB 状态和操作

### 2.3 数据库

- **SQLite**
- **存储内容**：
  - QB 容器配置（IP、端口、用户名、密码）
  - 种子缓存（id、状态、大小、完成进度、标签等）
  - 用户偏好配置（排序、显示列、主题等）

---

## 3. 功能需求

### 3.1 QB 容器管理

- 添加 / 删除 QB 容器
- 设置容器 IP、端口、用户名、密码
- 切换当前管理的 QB 容器
- 自动验证容器可达性

### 3.2 种子管理

- 查看种子列表：
  - 支持分页 / 虚拟滚动（react-window）
  - 显示信息：名称、大小、进度、下载/上传速度、状态、标签
- 种子操作：
  - 开始 / 暂停
  - 删除（带/不带数据）
  - 添加标签 / 修改标签
  - 搜索与筛选
- 支持批量操作（多选种子）

### 3.3 页面与交互

- 响应式布局：
  - Desktop / Tablet / Mobile
- 动画效果：
  - 列表加载过渡动画
  - 弹窗 / 弹出菜单动画
  - 按钮点击动效
- 主题支持（可选 Dark/Light）
- 无限滚动列表，上千种子不卡顿

### 3.4 数据同步与缓存

- 后端缓存种子状态，前端通过 API 获取缓存数据
- 定时刷新种子状态（可配置时间间隔）
- 支持前端直接触发刷新

### 3.5 安全与数据存储

- SQLite 保存 QB 账户和偏好设置
- 密码存储可加密（可选）
- 前端无需直接访问数据库，一切通过后端 API

---

## 4. 性能要求

- 支持 1000+ 种子列表显示不卡顿
- 虚拟滚动实现列表渲染优化
- API 响应时间 < 100ms（读取缓存）
- 前端动画平滑，帧率 ≥ 60fps
- 支持同时管理 5-10 个 QB 容器

---

## 5. 部署要求

- **Docker 单容器部署**
  - 内含 Node.js 后端、SQLite 数据库、前端静态资源
- **配置文件**：
  - 支持通过环境变量配置默认 QB 容器、端口等
- **启动方式**：
  - `docker run -p 3000:3000 qb-manager`
  - 前端页面在 `http://宿主机IP:3000` 访问
- **持久化**：
  - SQLite 数据库卷挂载到宿主机，保证重启数据不丢失

---

## 6. Docker 架构示意

```
┌────────────────────┐
│    用户浏览器      │
│ (Chrome / Safari)  │
└─────────┬──────────┘
          │ HTTPS / API
          ▼
┌────────────────────┐
│  Node.js + Fastify │
│  - REST API        │
│  - WebSocket       │
│  - QB 容器管理     │
└─────────┬──────────┘
          │ SQLite
          ▼
┌────────────────────┐
│     SQLite DB      │
│  - QB 账户信息     │
│  - 种子缓存        │
│  - 用户偏好        │
└─────────┬──────────┘
          │ HTTP / RPC
          ▼
┌────────────────────┐
│  多个 QB 容器      │
│  - 下载种子        │
│  - 提供 Web API    │
└────────────────────┘
```

---

## 7. 可选功能（后续迭代）

- 前端仪表盘：显示下载速度、上传速度、总任务数
- WebSocket 推送更新，减少前端轮询
- 用户权限管理
- 主题自定义（颜色、布局）
- 种子文件预览（图片/视频缩略图）

